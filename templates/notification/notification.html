{% extends 'base.html' %}

{% block title %}
(주) 곡반 보더스 / KBB - 알림
{% endblock %}



{% block content %}

<h3> 새로운 알림 </h3>
{% for noti in notifications %}
    {% if not noti.is_read %}
        <div>
            <span>{{ noti.created_at }}</span>
            <span>{{ noti.notification_name }}</span>
            <span>{{ noti.notification_content }}</span>
            <span>{{ noti.notification_type }}</span>
            <span><a href="{{ noti.notification_link }}" onclick="set_read({{noti.notification_id}})"> 바로가기 </a></span>
        </div>
    {% endif %}
{% endfor %}


<h3> 확인 한 알림 </h3>
{% for noti in notifications %}
    {% if noti.is_read %}
        <div>
            <span>{{ noti.created_at }}</span>
            <span>{{ noti.notification_name }}</span>
            <span>{{ noti.notification_content }}</span>
            <span>{{ noti.notification_type }}</span>
            <span><a href="{{ noti.notification_link }}" onclick="set_read({{noti.notification_id}})"> 바로가기 </a></span>
        </div>
    {% endif %}
{% endfor %}



<script>

    function set_read(id){
        const url = `/notification/${id}/read/`;
        fetch(url)
            .then( response => {
                if(response.redirected){
                    window.location.href = response.url
                }
                else{
                    console.log(response.json())
                }
            })
    }

    
</script>
{% endblock %}